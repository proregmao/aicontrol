---
type: "auto"
description: "设计文档与开发实现一致性强制规则"
---

# 设计文档与开发实现一致性强制规则

## 🚨 核心问题解决

### 问题：开发实现与设计文档严重不符
**根本原因**: 第三阶段开发时没有严格按照第二阶段设计文档执行

## 🔒 强制执行规则

### 📋 第三阶段开发前强制检查

**🚫 禁止开始开发，除非通过以下检查：**

#### 1. **设计文档完整性验证**
```bash
#!/bin/bash
echo "🔍 检查第二阶段设计文档完整性..."

# 检查必需的设计文档
required_docs=(
  "docs/02-design/architecture.md"
  "docs/02-design/database-design.md" 
  "docs/02-design/api-specification.md"
  "docs/02-design/ui-design/design-system.md"
  "docs/02-design/ui-design/common-styles.css"
)

missing_docs=()
for doc in "${required_docs[@]}"; do
  if [ ! -f "$doc" ]; then
    missing_docs+=("$doc")
  fi
done

if [ ${#missing_docs[@]} -gt 0 ]; then
  echo "❌ 缺少以下设计文档："
  printf '%s\n' "${missing_docs[@]}"
  echo "🚫 禁止开始第三阶段开发！"
  exit 1
fi

# 检查UI设计HTML文件
ui_html_files=$(find docs/02-design/ui-design/ -name "*.html" | wc -l)
if [ "$ui_html_files" -lt 3 ]; then
  echo "❌ UI设计HTML文件不足（需要至少3个页面设计）"
  echo "🚫 禁止开始第三阶段开发！"
  exit 1
fi

echo "✅ 设计文档完整性检查通过"
```

#### 2. **开发任务清单强制设计对照**

**🚫 禁止制定开发任务清单，除非：**

```bash
#!/bin/bash
echo "🔍 强制执行设计文档对照任务制定..."

# 创建设计对照检查清单
cat > design_checklist.md << 'EOF'
# 设计文档对照开发任务清单

## 📋 必须逐项对照的设计文档

### 1. UI设计系统对照
- [ ] 查阅 `docs/02-design/ui-design/design-system.md`
- [ ] 确认颜色规范：主色调、辅助色、状态色
- [ ] 确认字体规范：字体族、字号、行高
- [ ] 确认间距规范：边距、内边距、组件间距
- [ ] 确认圆角规范：按钮、卡片、输入框圆角值
- [ ] 确认阴影规范：卡片阴影、悬停效果

### 2. 通用样式对照
- [ ] 查阅 `docs/02-design/ui-design/common-styles.css`
- [ ] 确认整体布局：固定宽度、居中方式
- [ ] 确认导航结构：左侧菜单、顶部工具栏
- [ ] 确认背景效果：渐变背景、毛玻璃效果
- [ ] 确认响应式断点：桌面端、平板端、移动端

### 3. 页面设计对照
- [ ] 查阅每个页面的HTML设计文件
- [ ] 确认页面布局结构
- [ ] 确认组件层次关系
- [ ] 确认交互行为定义
- [ ] 确认数据展示方式

### 4. 组件设计对照
- [ ] 查阅组件库设计文档
- [ ] 确认每个组件的视觉规范
- [ ] 确认组件的交互规范
- [ ] 确认组件的状态变化

## ⚠️ 强制要求
每个开发任务都必须明确引用对应的设计文档章节！
EOF

echo "✅ 设计对照清单已创建"
```

### 💻 第三阶段开发过程强制规则

#### 1. **每个组件开发前强制设计查阅**

```markdown
**🚫 禁止开发任何组件，除非先执行：**

1. **查阅对应设计文档**
   ```bash
   # 开发前必须执行
   echo "开发组件: [组件名]"
   echo "查阅设计文档: [具体文档路径]"
   echo "设计要求摘要: [关键设计要求]"
   ```

2. **创建组件设计对照表**
   ```markdown
   ## 组件设计对照表
   
   | 设计要求 | 设计文档来源 | 实现状态 |
   |---------|-------------|----------|
   | 颜色规范 | design-system.md#颜色 | ✅/❌ |
   | 尺寸规范 | design-system.md#尺寸 | ✅/❌ |
   | 交互效果 | [页面].html#交互 | ✅/❌ |
   ```

3. **实现后强制对照验证**
   ```bash
   # 组件完成后必须执行
   echo "🔍 验证组件与设计文档一致性..."
   # 对比实现的样式与设计文档要求
   # 截图对比实际效果与设计HTML效果
   ```
```

#### 2. **页面开发强制设计复现**

```markdown
**🚫 禁止开发任何页面，除非：**

1. **先在浏览器中打开对应的设计HTML文件**
   ```bash
   # 必须先查看设计效果
   open docs/02-design/ui-design/dashboard.html
   # 或在浏览器中打开查看设计效果
   ```

2. **逐个元素对照实现**
   - 布局结构必须与设计HTML一致
   - 颜色必须与common-styles.css一致  
   - 间距必须与设计规范一致
   - 交互效果必须与设计说明一致

3. **实现后强制视觉对比**
   ```bash
   # 必须截图对比
   echo "📸 截图对比设计效果与实现效果"
   echo "设计效果: [设计HTML截图]"
   echo "实现效果: [实际页面截图]"
   echo "差异分析: [列出所有差异]"
   ```
```

### 🔍 第三阶段完成前强制一致性验证

```bash
#!/bin/bash
echo "🔍 执行设计实现一致性最终验证..."

# 1. 视觉效果对比
echo "📸 进行视觉效果对比..."
for design_file in docs/02-design/ui-design/*.html; do
  page_name=$(basename "$design_file" .html)
  echo "对比页面: $page_name"
  echo "设计文件: $design_file"
  echo "实现页面: http://localhost:3001/$page_name"
  echo "❗ 必须人工截图对比，确认视觉效果一致"
done

# 2. 样式规范检查
echo "🎨 检查样式规范一致性..."
grep -r "color:" src/ | head -10
echo "❗ 检查颜色是否符合design-system.md规范"

grep -r "font-size:" src/ | head -10  
echo "❗ 检查字体大小是否符合设计规范"

# 3. 布局结构检查
echo "📐 检查布局结构一致性..."
echo "❗ 检查是否有左侧导航菜单（设计要求）"
echo "❗ 检查是否为固定宽度居中布局（设计要求）"
echo "❗ 检查是否有毛玻璃效果（设计要求）"

# 4. 强制修复差异
echo "🔧 发现差异必须立即修复..."
echo "❌ 禁止声称开发完成，直到所有差异修复"
```

## 📋 规则修改建议

### 修改 `.augment/rules/roles.md` 第三阶段部分

在第三阶段任务清单前添加：

```markdown
### 🚫 开发前强制检查

**禁止开始开发，除非通过以下检查：**

1. **执行设计文档完整性验证脚本**
2. **创建设计对照开发任务清单** 
3. **确认每个任务都引用了具体设计文档**

### 🔍 开发过程强制规则

**每个组件/页面开发时必须：**

1. **开发前**: 查阅对应设计文档，创建设计对照表
2. **开发中**: 严格按照设计文档实现，不得自由发挥
3. **开发后**: 截图对比设计效果与实现效果

### ✅ 完成前强制验证

**禁止声称开发完成，除非：**

1. **通过设计实现一致性验证脚本**
2. **提供所有页面的视觉对比截图**
3. **修复所有发现的设计差异**
```

这样可以确保第三阶段严格按照第二阶段设计文档执行，避免实现与设计脱节的问题。
